{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ILHAME/OneDrive/Documents/GitHub/tech_bible_react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/ILHAME/OneDrive/Documents/GitHub/tech_bible_react/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Users/ILHAME/OneDrive/Documents/GitHub/tech_bible_react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/ILHAME/OneDrive/Documents/GitHub/tech_bible_react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import\"../assets/styles/community/community.css\";import\"../assets/styles/home/global.css\";import Comment from\"../components/Community/Comment\";import Topic from\"../components/Community/Topic\";import Discussion from\"../components/Community/Discussion\";import{useEffect}from\"react\";import{collection,doc,getDocs,onSnapshot}from\"firebase/firestore\";import{db}from\"../config/firebase\";import{Link}from\"react-router-dom\";import{CategoriesData}from\"../dataJson/CategoriesData\";import axios from\"axios\";import{BASE_URL}from\"../config/mongo\";import DiscussionsPage from\"../components/Community/DiscussionsPage\";import DiscussionReply from\"./DiscussionReply\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Community(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),Discussions=_useState4[0],setDiscussions=_useState4[1];var _useState5=useState(\"All\"),_useState6=_slicedToArray(_useState5,2),selectedFilter=_useState6[0],setSelectedFilter=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isRepliesClicked=_useState8[0],setIsRepliesClicked=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),discussion=_useState10[0],setDiscussion=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),userInfo=_useState12[0],setUserInfo=_useState12[1];//Fetch Disscutions\nvar fetchDiscussions=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data,sortedDiscussions,discussionsWithTimeAgo;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"\".concat(BASE_URL,\"/discussions\"));case 2:response=_context.sent;data=response.data;// Sort the discussions by updatedAt field in descending order\nsortedDiscussions=data.sort(function(a,b){return new Date(b.createdAt)-new Date(a.createdAt);});// Calculate the time difference in seconds, minutes, hours, days, or years for each comment and format it\ndiscussionsWithTimeAgo=sortedDiscussions.map(function(discussion){var createdAt=new Date(discussion.createdAt);var currentDate=new Date();var timeDifferenceInSeconds=Math.floor((currentDate-createdAt)/1000);var formattedTimeAgo;if(timeDifferenceInSeconds<1){formattedTimeAgo=\"Now\";}else if(timeDifferenceInSeconds<60){formattedTimeAgo=\"\".concat(timeDifferenceInSeconds,\"s ago\");}else if(timeDifferenceInSeconds<3600){var minutes=Math.floor(timeDifferenceInSeconds/60);formattedTimeAgo=\"\".concat(minutes,\"m ago\");}else if(timeDifferenceInSeconds<86400){var hours=Math.floor(timeDifferenceInSeconds/3600);formattedTimeAgo=\"\".concat(hours,\"h ago\");}else if(timeDifferenceInSeconds<31536000){var days=Math.floor(timeDifferenceInSeconds/86400);formattedTimeAgo=\"\".concat(days,\"d ago\");}else{var years=Math.floor(timeDifferenceInSeconds/31536000);formattedTimeAgo=\"\".concat(years,\"y ago\");}return _objectSpread(_objectSpread({},discussion),{},{timeAgo:formattedTimeAgo});});setDiscussions(discussionsWithTimeAgo);case 7:case\"end\":return _context.stop();}},_callee);}));return function fetchDiscussions(){return _ref.apply(this,arguments);};}();var toggleDropdown=function toggleDropdown(){setIsOpen(!isOpen);};useEffect(function(){fetchDiscussions();},[selectedFilter]);return/*#__PURE__*/_jsx(\"div\",{children:!isRepliesClicked?/*#__PURE__*/_jsx(DiscussionsPage,{toggleDropdown:toggleDropdown,isOpen:isOpen,setIsOpen:setIsOpen,Discussions:Discussions,discussion:discussion,CategoriesData:CategoriesData,setDiscussion:setDiscussion,setIsRepliesClicked:setIsRepliesClicked,setUserInfo:setUserInfo,selectedFilter:selectedFilter,setSelectedFilter:setSelectedFilter}):/*#__PURE__*/_jsx(\"div\",{children:isRepliesClicked&&/*#__PURE__*/_jsxs(\"div\",{onClick:function onClick(){setIsRepliesClicked(false);},className:\"flex flex-row ml-6 mb-6 mt-14 gap-2 transition duration-250 text-[18px] hover:tracking-[.3px] cursor-pointer\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",fill:\"none\",viewBox:\"0 0 24 24\",\"stroke-width\":\"1.5\",stroke:\"currentColor\",class:\"w-6 h-6\",children:/*#__PURE__*/_jsx(\"path\",{\"stroke-linecap\":\"round\",\"stroke-linejoin\":\"round\",d:\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\"})}),/*#__PURE__*/_jsx(\"div\",{children:\"Back to discussions\"})]})})});}export default Community;","map":{"version":3,"names":["React","useState","Comment","Topic","Discussion","useEffect","collection","doc","getDocs","onSnapshot","db","Link","CategoriesData","axios","BASE_URL","DiscussionsPage","DiscussionReply","jsx","_jsx","jsxs","_jsxs","Community","_useState","_useState2","_slicedToArray","isOpen","setIsOpen","_useState3","_useState4","Discussions","setDiscussions","_useState5","_useState6","selectedFilter","setSelectedFilter","_useState7","_useState8","isRepliesClicked","setIsRepliesClicked","_useState9","_useState10","discussion","setDiscussion","_useState11","_useState12","userInfo","setUserInfo","fetchDiscussions","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","sortedDiscussions","discussionsWithTimeAgo","wrap","_callee$","_context","prev","next","get","concat","sent","sort","a","b","Date","createdAt","map","currentDate","timeDifferenceInSeconds","Math","floor","formattedTimeAgo","minutes","hours","days","years","_objectSpread","timeAgo","stop","apply","arguments","toggleDropdown","children","onClick","className","xmlns","fill","viewBox","stroke","class","d"],"sources":["C:/Users/ILHAME/OneDrive/Documents/GitHub/tech_bible_react/src/views/Community.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport \"../assets/styles/community/community.css\";\r\nimport \"../assets/styles/home/global.css\";\r\nimport Comment from \"../components/Community/Comment\";\r\nimport Topic from \"../components/Community/Topic\";\r\nimport Discussion from \"../components/Community/Discussion\";\r\nimport { useEffect } from \"react\";\r\nimport { collection, doc, getDocs, onSnapshot } from \"firebase/firestore\";\r\nimport { db } from \"../config/firebase\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { CategoriesData } from \"../dataJson/CategoriesData\";\r\nimport axios from \"axios\";\r\nimport { BASE_URL } from \"../config/mongo\";\r\nimport DiscussionsPage from \"../components/Community/DiscussionsPage\";\r\nimport DiscussionReply from \"./DiscussionReply\";\r\n\r\nfunction Community() {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [Discussions, setDiscussions] = useState([]);\r\n  const [selectedFilter, setSelectedFilter] = useState(\"All\");\r\n  const [isRepliesClicked, setIsRepliesClicked] = useState(false);\r\n  const [discussion, setDiscussion] = useState();\r\n  const [userInfo, setUserInfo] = useState();\r\n  \r\n\r\n  //Fetch Disscutions\r\n  const fetchDiscussions = async () => {\r\n    const response = await axios.get(`${BASE_URL}/discussions`);\r\n    const data = response.data;\r\n\r\n    // Sort the discussions by updatedAt field in descending order\r\n    const sortedDiscussions = data.sort((a, b) => {\r\n      return new Date(b.createdAt) - new Date(a.createdAt);\r\n    });\r\n\r\n   \r\n\r\n    // Calculate the time difference in seconds, minutes, hours, days, or years for each comment and format it\r\n    const discussionsWithTimeAgo = sortedDiscussions.map((discussion) => {\r\n      const createdAt = new Date(discussion.createdAt);\r\n      const currentDate = new Date();\r\n      const timeDifferenceInSeconds = Math.floor(\r\n        (currentDate - createdAt) / 1000\r\n      );\r\n\r\n      let formattedTimeAgo;\r\n      if (timeDifferenceInSeconds < 1) {\r\n        formattedTimeAgo = \"Now\";\r\n      } else if (timeDifferenceInSeconds < 60) {\r\n        formattedTimeAgo = `${timeDifferenceInSeconds}s ago`;\r\n      } else if (timeDifferenceInSeconds < 3600) {\r\n        const minutes = Math.floor(timeDifferenceInSeconds / 60);\r\n        formattedTimeAgo = `${minutes}m ago`;\r\n      } else if (timeDifferenceInSeconds < 86400) {\r\n        const hours = Math.floor(timeDifferenceInSeconds / 3600);\r\n        formattedTimeAgo = `${hours}h ago`;\r\n      } else if (timeDifferenceInSeconds < 31536000) {\r\n        const days = Math.floor(timeDifferenceInSeconds / 86400);\r\n        formattedTimeAgo = `${days}d ago`;\r\n      } else {\r\n        const years = Math.floor(timeDifferenceInSeconds / 31536000);\r\n        formattedTimeAgo = `${years}y ago`;\r\n      }\r\n\r\n      return {\r\n        ...discussion,\r\n        timeAgo: formattedTimeAgo,\r\n      };\r\n    });\r\n\r\n    setDiscussions(discussionsWithTimeAgo);\r\n    \r\n  };\r\n\r\n  const toggleDropdown = () => {\r\n    setIsOpen(!isOpen);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDiscussions();\r\n  }, [selectedFilter]);\r\n\r\n  return (\r\n    <div>\r\n      {!isRepliesClicked ? (\r\n        <DiscussionsPage\r\n          toggleDropdown={toggleDropdown}\r\n          isOpen={isOpen}\r\n          setIsOpen={setIsOpen}\r\n          Discussions={Discussions}\r\n          discussion={discussion}\r\n          CategoriesData={CategoriesData}\r\n          setDiscussion={setDiscussion}\r\n          setIsRepliesClicked={setIsRepliesClicked}\r\n          setUserInfo={setUserInfo}\r\n          selectedFilter={selectedFilter}\r\n          setSelectedFilter={setSelectedFilter}\r\n        />\r\n      ) : (\r\n        <div>\r\n          {isRepliesClicked && (\r\n            <div\r\n              onClick={() => {\r\n                setIsRepliesClicked(false);\r\n              }}\r\n              className=\"flex flex-row ml-6 mb-6 mt-14 gap-2 transition duration-250 text-[18px] hover:tracking-[.3px] cursor-pointer\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke-width=\"1.5\"\r\n                stroke=\"currentColor\"\r\n                class=\"w-6 h-6\"\r\n              >\r\n                <path\r\n                  stroke-linecap=\"round\"\r\n                  stroke-linejoin=\"round\"\r\n                  d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\"\r\n                />\r\n              </svg>\r\n\r\n              <div>Back to discussions</div>\r\n            </div>\r\n          )}\r\n\r\n          {/* <DiscussionReply\r\n            discussion={discussion}\r\n            userInfo={userInfo}\r\n            Discussions={Discussions}\r\n            fetchDiscussions={fetchDiscussions}\r\n          /> */}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Community;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}